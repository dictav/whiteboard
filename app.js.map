{"version":3,"sources":["init.coffee","note.coffee","stroke.coffee"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["clickCount = 0\ntimer = null\n\ncanvasListner = ->\n  canvas = $('#canvas')\n  canvas.attr('width', canvas.width())\n  canvas.attr('height', canvas.height())\n\n  canvas.on 'click', (e)->\n    if Note.editingNote\n      Note.editingNote.setEditing(false)\n      return\n\n    if Stroke.drawingStroke\n      Stroke.drawingStroke.save()\n      return\n\n    clickCount++\n    console.log 'canvas click count', clickCount\n\n    if clickCount == 1\n      timer = setTimeout( ()->\n        clickCount = 0\n        style =\n          top:    e.pageY,\n          left:   e.pageX,\n        Note.create \"create a new note\", style\n      , 300)\n    else\n      clickCount = 0\n      Stroke.drawingStroke = Stroke.create( {x: e.pageX, y: e.pageY} )\n      clearTimeout timer\n   .on 'dblclick', (e)->\n    e.preventDefault()\n\n  canvas.on 'mousemove', (e)->\n    return unless Stroke.drawingStroke\n    Stroke.drawingStroke.addPath({x:e.pageX, y:e.pageY})\n\n  $(document).on 'keyup', (e)->\n    console.log 'keyup', e.keyCode\n    stroke = Stroke.drawingStroke\n    return unless stroke\n\n    path = null\n    switch e.keyCode\n      when 37 then path = {x:0, y:stroke.paths.last().y}\n      when 38 then path = {x:stroke.paths.last().x, y:0}\n      when 39 then path = {x:$(this).width(), y:stroke.paths.last().y}\n      when 40 then path = {x:stroke.paths.last().x, y:$(this).height()}\n      else\n        return\n    stroke.addPath path\n    stroke.save()\n\nlistenActions = ->\n  canvasListner()\n\n  $('#dialog_yes').click ->\n    if Note.completeNote\n      Note.completeNote.complete()\n    $('#dialog').hide()\n  $('#dialog_no').click ->\n    $('#dialog').hide()\n\n  $('#color_panel').on('click', ->\n    if this.className == 'inactive'\n      this.className = \"active\"\n    else\n      this.className = 'inactive'\n  )\n\n  $('#color_panel div').on('click', ->\n    parent = $('#color_panel').first()\n    if parent.hasClass 'inactive'\n      return\n    tmp = document.createElement 'div'\n    current = parent.children()[2]\n    parent[0].replaceChild(tmp, this)\n    parent[0].replaceChild(this, current)\n    parent[0].replaceChild(current, tmp)\n    Note.default.backgroundColor = $(this).css('backgroundColor')\n  )\n\n\ninit = ->\n    client = new WindowsAzure.MobileServiceClient(\n      'https://whiteboard.azure-mobile.net/',\n      'ayQItbHiEURdZHPJXAyjjTrIRXWUog83')\n    Note.table = client.getTable('todoitem')\n    Stroke.table = client.getTable('strokepath')\n\nhandleError = (error) ->\n  console.log \"ERR\",error\n\n$(document).ready ->\n  init()\n  listenActions()\n  Note.refresh()\n  Note.deleteGomi()\n  Stroke.refresh()\n\n","class window.Note\n  @table = null\n  @editingNote = null\n  @completeNote = null\n  @allNotes = []\n  @imgreg = /^https?:\\/\\/(?:[a-z0-9\\-_]+\\.)+[a-z]{2,6}(?:\\/[^\\/#?]+)+\\.(?:jpe?g|gif|png)$/\n  @ytreg = /^https?:\\/\\/www.youtube.com\\/watch\\?v=(.+)/\n  @default =\n    width: \"100px\"\n    height: \"100px\"\n    backgroundColor: \"red\"\n\n  # class methods\n  @deleteGomi: ->\n    Note.table.where({text: \"create a new note\"}).read()\n      .then (items)->\n        console.log 'delete',items.length, 'items'\n        for item in items\n          Note.table.del {id: item.id}\n        console.log 'delete done'\n      , handleError\n\n  @refresh: ->\n    note.remove() for note in @allNotes\n    window.Note.allNotes = []\n    query = Note.table.where({complete: false}).read()\n      .then( (items)->\n        for item in items\n          note = new Note(item)\n          window.Note.allNotes.push(note)\n          document.body.appendChild note.view\n      , window.handleError)\n\n  @create: (text,style)->\n    for k,v of @default\n      style[k] ||= v\n    data =\n      text: text\n      style: JSON.stringify style\n      complete: false\n    note = new Note(data)\n    @allNotes.push note\n    note.insert()\n    note\n\n  # instance methods\n  constructor:(@item) ->\n    @clickCount = 0\n    @timer = null\n    v = $(@build())\n\n  insert: ->\n    Note.table.insert(@item)\n      .then( (data)->\n        console.log 'inserted note', data\n      , window.handleError)\n\n  update: (data)->\n    data.id = @item.id\n    Note.table.update(data)\n      .then( (data)->\n        console.log 'updated note', data\n      , window.handleError)\n  complete: ->\n      Note.table.update(\n        id: @item.id\n        complete: true\n      ).then  =>\n        console.log 'completed'\n        $(@view).remove()\n      , handleError\n  \n  setEditing: (tof)=>\n    if tof\n      Note.editingNote = this\n      @replaceTextArea()\n    else\n      @item.text = $('textarea', @view).first().val()\n      @update(text: @item.text)\n      Note.editingNote = null\n      @rebuild()\n\n  rebuild: ->\n    $(@view).remove()\n    @build()\n\n  build: ->\n    div = document.createElement(\"div\")\n    div.className = \"note\"\n    div.id = @item.id\n    style = JSON.parse(@item.style)\n    $(div).css(style)\n    createContent(div, @item.text)\n    document.body.appendChild div\n    @view = div\n    $(@view).on 'click', @clickHandler\n      .on 'dblclick', (e)-> e.preventDefault()\n      .draggable\n        stop: (e,ui)=>\n          $(@view).addClass 'noclick'\n          @item.style = JSON.stringify(extractStyle(@view))\n          @update\n            style: @item.style\n    @view\n\n  remove: ->\n    $(this).remove()\n\n  clickHandler: (e)=>\n    if $(@view).hasClass 'noclick'\n      $(@view).removeClass 'noclick'\n      return\n\n    $(this).css('z-index',999)\n    if Note.editingNote\n      flag =  Note.editingNote == this\n      Note.editingNote.setEditing(false)\n      @clickCount = 0\n      return if flag\n\n    @clickCount++\n    if @clickCount == 1\n      @timer = setTimeout( ()=>\n        @clickCount = 0\n        @setEditing(true)\n      , 500)\n    else\n      @clickCount = 0\n      clearTimeout(@timer)\n      Note.completeNote = this\n      $('#dialog').show()\n\n\n  extractStyle = (dom)->\n    {\n      backgroundColor: $(dom).css(\"backgroundColor\"),\n      height:          $(dom).height(),\n      width:           $(dom).width(),\n      left:            $(dom).css(\"left\"),\n      top:             $(dom).css(\"top\")\n    }\n\n  replaceTextArea: ->\n    tarea = document.createElement('textarea')\n    tarea.value = @view.innerHTML\n    $(tarea).width( $(@view).width() )\n    $(tarea).height( $(@view).height() )\n    @view.innerHTML = \"\"\n    @view.appendChild tarea\n    tarea.select()\n\n  createContent = (div, src)->\n    content = if m = src.match Note.ytreg\n                createYoutbue(m[1])\n              else if src.match(Note.imgreg)\n                img = document.createElement 'img'\n                img.src = src\n                img\n              else\n                document.createTextNode(src)\n    div.appendChild content\n\n\n  createYoutbue = (id)->\n    iframe = document.createElement 'iframe'\n    iframe.className = 'youtube-player'\n    iframe.type = \"text/html\"\n    iframe.src =\"http://www.youtube.com/embed/\" + id + \"?rel=0\"\n    $(iframe).attr(\"frameborder\", \"0\")\n    $(iframe).attr(\"autoplay\", \"1\")\n    iframe\n\n","class window.Stroke\n  @table = null\n  @allStrokes = []\n  @drawingStroke = null\n  @default =\n    width: 8\n    color: \"rgba(0,0,0,0.5)\"\n\n\n  @create: (path)->\n    data =\n      width: Stroke.default.width\n      color: Stroke.default.color\n      data: JSON.stringify [path]\n    stroke = new Stroke(data)\n    @allStrokes.push stroke\n    console.log 'create stroke', stroke\n    stroke\n\n  @refresh: ->\n    condition = -> this.data != \"\"\n\n    query = Stroke.table.where(condition).read().then (strokes)->\n      console.log 'strokes',strokes\n      @allStokes = new Stroke(stroke) for stroke in strokes\n\n  constructor: (@stroke)->\n    @paths = JSON.parse @stroke.data\n    @paths.last = ->\n      this[this.length-1]\n    @context = $('canvas')[0].getContext('2d')\n    @context.strokeStyle = @stroke.color\n    @context.lineWidth = @stroke.width\n    @build()\n\n  build: ->\n    @context.beginPath()\n    for path,i in @paths\n      if i == 0\n        @context.moveTo(path.x, path.y)\n      else\n        @context.lineTo(path.x, path.y)\n    @context.stroke()\n    @context.closePath()\n\n  addPath: (path)->\n    x = path.x\n    y = path.y\n    if (@paths.last().x - x)**2 + (@paths.last().y - y)**2 < 300\n      return\n    @context.beginPath()\n    @context.moveTo(@paths.last().x, @paths.last().y)\n    @context.lineTo(x, y)\n    @context.stroke()\n    @context.closePath()\n    @paths.push path\n\n  save: ->\n    Stroke.drawingStroke = null\n    @insert()\n\n  insert: ->\n    console.log @stroke\n    data =\n      width: @stroke.width,\n      color: @stroke.color,\n      data: JSON.stringify(@paths)\n    console.log 'insert stroke', data\n    Stroke.table.insert(data)\n      .then (stroke)->\n        console.log 'inserted stroke', stroke\n      , handleError\n\n  update: (data)->\n    console.log data\n    data.id = @stroke.id\n    Stroke.table.update(data)\n      .then (data)->\n        console.log 'update stroke', data\n      , window.handleError\n\n"],"sourceRoot":"/app"}